<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="memberMapper">

<resultMap type="member" id="memberResultSet">
	<id column="USER_NO" property="userNo" />
	<result column="ENO" property="eno" />
	<result column="STATUS" property="status" />
	<result column="PROFILE_IMG" property="profileImg" />
	<result column="STATUS_TYPE" property="statusType" />
	<result column="USER_PWD" property="userPwd" />
	<result column="USER_NAME" property="userName" />
	<result column="PHONE" property="phone" />
	<result column="EXTENSION" property="extension" />
	<result column="EMAIL" property="email" />
	<result column="ADDRESS" property="address" />
	<result column="ANNUAL_LEAVE_COUNT" property="annualLeaveCount" />
	<result column="HIRE_DATE" property="hireDate" />
</resultMap>

<insert id="insertMember" parameterType="member" useGeneratedKeys="true" >

	<selectKey keyProperty="eno" resultType="_int" order="BEFORE">
 		SELECT CTCAST(CONCAT(DATE_FORMAT(CURRENT_DATE, '%y'), LPAD(MONTH(CURRENT_DATE), 2, '0'), LPAD(right(
   	(SELECT ENO FROM member ORDER BY ENO DESC LIMIT 1)+1,2)
   	,2,'0')) as SIGNED
 		FROM DUAL
 	</selectKey>

	INSERT INTO MEMBER(ENO,STATUS_TYPE, USER_PWD, USER_NAME ,PHONE,EXTENSION, EMAIL,ADDRESS, HIRE_DATE)
   	VALUES(
   	#{eno},
   	0,
   	#{userPwd},
   	#{userName},
   	#{phone},
   	#{extension},
   	#{email},
   	#{address},
   	#{hireDate})
  		
</insert>

<!-- [지의] - 로그인 -->
<select id="loginMember" parameterType="member" resultMap="memberResultSet">
	SELECT *
	  FROM MEMBER
	 WHERE ENO = #{eno}
	   AND USER_PWD = #{userPwd}
	   AND STATUS = 'Y'
</select>



</mapper>
